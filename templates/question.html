{% extends "base.html" %} {% block title %} - {% if question %} Edit {% else -%} Add new {% endif %} Record{% endblock %}
{% block content %} {% set last_answer = [] %}
<div id="body-question" class="container">
    <h1 class="title-text-question">{{ data['question'][0]['title'] }}</h1>
    <div class="table-div">
        <table class="table-form">
            <tr>
                <td>
                    <div>
                        <span class="vote-num"><a href="/question/{{ data['question'][0]['id'] }}/vote-up"><span class="glyphicon glyphicon-chevron-up" aria-hidden="true"></span></a>
                        </span>
                    </div>
                    <div>
                        <span class="vote-num"><a href="/question/{{ data['question'][0]['id'] }}/vote-down"><span class="glyphicon glyphicon-chevron-down" aria-hidden="true"></span></a>
                        </span>
                    </div>
                </td>
                <td>
                    <span>{{ data['question'][0]['vote_number'] }}</span>
                </td>
                <td>
                    <span>{{ data['question'][0]['question_date'] }}</span>
                </td>
                <td>
                    {% autoescape false %}
                    <span>{{ data['question'][0]['question_body']|replace("\n", "<br/>") }}</span> {% endautoescape %}
                </td>
                <td>
                    <span>{{ data['question'][0]['view_number'] }}</span>
                </td>
                <td>
                    <a href="/question/{{ data['question'][0]['id'] }}/edit"><span class="glyphicon glyphicon-pencil" aria-hidden="true"></span></a>
                    <a href="/question/{{ data['question'][0]['id'] }}/delete"><span class="glyphicon glyphicon-trash" aria-hidden="true"></span></a>
                    <a href="/question/{{ data['question'][0]['id'] }}/new-comment" /><span class="glyphicon glyphicon-comment"
                        aria-hidden="true"></span></a>
                    </span>

                </td>
            </tr>
        </table>
        <a href="/question/{{ data['question'][0]['id'] }}/new-answer" class="btn btn-success add-ans">Add an answer</a>
    </div>
    <br />
    <div>
        {% for comment in data['question'] %} {% if comment['comment_body'] %}
        <table class="table-form">
            <tr>
                <td>
                    <span>{{ comment['comment_date'] }}</span>
                </td>
                <td>
                    {% autoescape false %}
                    <span>{{ comment['comment_body']|replace("\n", "<br/>") }}</span> {% endautoescape %}
                </td>
                <td>
                    <span><a href="/comments/{{ comment['comment_id'] }}/delete"><span class="glyphicon glyphicon-trash" aria-hidden="true"></span></a>
                    </span>
                </td>
            </tr>
        </table>
    </div>
    {% endif %} {% endfor %} {% if data['answer'] %}
    <div>
        {% for item in data['answer'] %} {% if item['answer_id'] not in last_answer %}
        <h3 class="title-text-question">Answer {{ last_answer|length + 1 }}</h3>
        <table class="table-form">
            <tr>
                <td>
                    <div>
                        <a href="/answer/{{item['answer_id']}}/vote-up"><span class="glyphicon glyphicon-chevron-up" aria-hidden="true"></span></a>
                    </div>
                    <div>
                        <a href="/answer/{{item['answer_id']}}/vote-down"><span class="glyphicon glyphicon-chevron-down" aria-hidden="true"></span></a>
                    </div>
                </td>
                <td>
                    <span>{{ item['vote_number'] }}</span>
                </td>
                <td>
                    <span>{{ item['answer_date'] }}</span>
                </td>
                <td>
                    {% autoescape false %}
                    <span>{{ item['answer_body']|replace("\n", "<br/>") }}</span> {% endautoescape %}
                </td>
                <td>
                    <a href="/answer/{{item['answer_id']}}/edit"><span class="glyphicon glyphicon-pencil" aria-hidden="true"></span></a>
                    <a href="/answer/{{item['answer_id']}}/delete"><span class="glyphicon glyphicon-trash" aria-hidden="true"></span></a>
                    <a href="/answer/{{item['answer_id']}}/new-comment" /><span class="glyphicon glyphicon-comment" aria-hidden="true"></span></a>

                </td>
            </tr>
        </table>
        {% for response in data['answer'] %} {% if response['comment_body'] %} {% if response['answer_id'] == item['answer_id'] %}
        <table class="table-form">
            <tr>
                <td>
                    <span>{{ response['comment_date'] }}</span>
                </td>
                <td>
                    {% autoescape false %}
                    <span>{{ response['comment_body']|replace("\n", "<br/>") }}</span> {% endautoescape %}
                </td>
                <td>
                    <a href="/comments/{{ response['comment_id'] }}/delete"><span class="glyphicon glyphicon-trash" aria-hidden="true"></span></a>
                    <a href="/comment/{{ response['comment_id'] }}/edit"><span class="glyphicon glyphicon-pencil" aria-hidden="true"></span></a>
                </td>
            </tr>
        </table>
        {% endif %} {% endif %} {% endfor %} {% do last_answer.append(item['answer_id']) %} {% endif %} {% endfor %}
    </div>
    {% else %}
    <div>
        <h1 class="title-text-question">No answers for this quesion yet.</h1>
    </div>
    {% endif %} {%- endblock content %}